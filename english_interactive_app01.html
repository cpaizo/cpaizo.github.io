<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magical Classroom Interactive English</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .word-red { color: #dc2626; font-weight: 700; cursor: pointer; border-bottom: 1px dashed #dc2626; transition: all 0.2s; }
        .word-red:hover { background-color: #fee2e2; color: #991b1b; }
        .tab-active { border-bottom: 4px solid #4f46e5; color: #4f46e5; }
        .bg-magic { background-color: #f8fafc; background-image: radial-gradient(#e2e8f0 1px, transparent 1px); background-size: 20px 20px; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .animate-fadeIn { animation: fadeIn 0.5s ease-in; }
        .reading-active { color: #4f46e5; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    </style>
</head>
<body class="bg-magic min-h-screen font-sans text-gray-900">

    <!-- é ‚éƒ¨å°è¦½ -->
    <nav class="bg-white shadow-lg p-4 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center">
            <h1 class="text-2xl font-black text-indigo-700 tracking-tight mb-4 md:mb-0">
                <i class="fas fa-hat-wizard mr-2"></i>MAGICAL CLASSROOM
            </h1>
            <div class="flex space-x-2">
                <button onclick="switchTab('scene')" id="btn-scene" class="px-5 py-2 font-bold transition tab-active uppercase text-sm">åœ–æ–‡æƒ…å¢ƒ</button>
                <button onclick="switchTab('vocab')" id="btn-vocab" class="px-5 py-2 font-bold transition uppercase text-sm text-gray-500">è©å½™è¡¨</button>
                <button onclick="switchTab('quiz')" id="btn-quiz" class="px-5 py-2 font-bold transition uppercase text-sm text-gray-500">å–®å­—æ¸¬é©—</button>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto p-4 md:p-8">
        
        <!-- 1. åœ–æ–‡æƒ…å¢ƒ -->
        <section id="scene-section" class="grid grid-cols-1 lg:grid-cols-2 gap-8 animate-fadeIn">
            <div class="space-y-6">
                <div class="bg-white p-4 rounded-2xl shadow-xl border-4 border-indigo-50">
                    <img src="photos/english.jpg" alt="Magical Classroom" class="rounded-lg w-full h-auto object-cover shadow-inner" onerror="this.src='https://placehold.co/600x400?text=Magical+Classroom+Image'">
                    <p class="mt-4 text-center text-sm text-indigo-400 font-medium">
                        <i class="fas fa-info-circle mr-1"></i> é»æ“Šæ•…äº‹ä¸­çš„ç´…è‰²å–®å­—å¯è†è½ç™¼éŸ³
                    </p>
                </div>
            </div>
            
            <div class="bg-white p-8 rounded-2xl shadow-xl border-t-8 border-indigo-500">
                <div class="flex justify-between items-center mb-6 border-b pb-4">
                    <h2 class="text-3xl font-bold text-gray-800">Story Time</h2>
                    <button id="read-story-btn" onclick="toggleStoryReading()" class="flex items-center space-x-2 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 px-4 py-2 rounded-full transition-all group">
                        <span id="read-btn-icon"><i class="fas fa-volume-up"></i></span>
                        <span id="read-btn-text" class="text-sm font-bold uppercase tracking-wider">è½å®Œæ•´æ•…äº‹</span>
                    </button>
                </div>
                <article id="story-content" class="text-lg leading-relaxed text-gray-700 space-y-4">
                    <!-- ç”± JS å‹•æ…‹ç”Ÿæˆ -->
                </article>
                <div class="mt-8 p-4 bg-indigo-50 rounded-lg border border-indigo-100">
                    <p class="text-sm text-indigo-800 leading-snug">
                        <strong>äº’å‹•æç¤ºï¼š</strong>é»æ“Šä»»ä½•ç´…è‰²æ¨™è¨˜çš„å–®å­—ï¼Œç³»çµ±å°‡è‡ªå‹•ç‚ºæ‚¨æœ—è®€ã€‚
                    </p>
                </div>
            </div>
        </section>

        <!-- 2. è©å½™è¡¨ -->
        <section id="vocab-section" class="hidden animate-fadeIn">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="vocab-grid">
                <!-- ç”± JS å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </section>

        <!-- 3. å–®å­—æ¸¬é©— -->
        <section id="quiz-section" class="hidden flex flex-col items-center animate-fadeIn">
            <div class="bg-white p-8 rounded-3xl shadow-2xl max-w-2xl w-full border-b-8 border-green-500">
                
                <div id="quiz-container" class="hidden">
                    <div class="flex justify-between items-center mb-8">
                        <span id="quiz-progress" class="px-4 py-1 bg-green-100 text-green-700 rounded-full text-sm font-bold">Question 1/10</span>
                        <div id="quiz-live-score" class="font-mono text-gray-400 font-bold">Score: 0</div>
                    </div>
                    <h2 class="text-2xl font-bold mb-8 text-center text-gray-800" id="quiz-question">æ­£åœ¨åŠ è¼‰é¡Œç›®...</h2>
                    <div class="grid grid-cols-1 gap-4" id="quiz-options"></div>
                    <div id="quiz-feedback" class="mt-6 p-4 rounded-xl hidden text-center font-bold"></div>
                    <button id="next-quiz-btn" onclick="nextQuestion()" class="mt-8 w-full bg-indigo-600 text-white py-4 rounded-xl font-bold hover:bg-indigo-700 shadow-lg transition hidden">
                        ä¸‹ä¸€é¡Œ <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>

                <div id="quiz-start-screen" class="text-center py-10">
                    <div class="text-6xl mb-6">ğŸ“</div>
                    <h2 class="text-2xl font-black mb-4">é­”æ³•æ•™å®¤æŒ‘æˆ°</h2>
                    <p class="mb-8 text-gray-500 text-lg">éš¨æ©Ÿ 10 é¡Œæ¸¬è©¦ï¼Œçœ‹çœ‹æ‚¨è¨˜ä½äº†å¤šå°‘å–®å­—ï¼</p>
                    <button onclick="startQuiz()" class="bg-green-500 text-white px-12 py-4 rounded-full text-xl font-black hover:bg-green-600 shadow-xl transform hover:scale-105 transition-all">
                        é–‹å§‹æ¸¬é©—
                    </button>
                </div>

                <div id="quiz-result-screen" class="hidden text-center py-10">
                    <div id="result-emoji" class="text-7xl mb-6">ğŸ†</div>
                    <h2 class="text-3xl font-black mb-2 text-gray-800">æ¸¬é©—å®Œæˆï¼</h2>
                    <p id="result-text" class="text-xl mb-8 text-indigo-600 font-bold"></p>
                    <div class="flex flex-col gap-4">
                        <button onclick="startQuiz()" class="bg-indigo-600 text-white px-8 py-4 rounded-xl font-bold hover:bg-indigo-700 shadow-lg transition">
                            å†è©¦ä¸€æ¬¡
                        </button>
                        <button onclick="switchTab('vocab')" class="text-indigo-500 font-bold hover:underline">
                            å›è©å½™è¡¨è¤‡ç¿’
                        </button>
                    </div>
                </div>

            </div>
        </section>

    </main>

    <script>
        const wordData = [
            { en: "benches", ipa: "/ËˆbentÊƒÉªz/", zh: "é•·å‡³", sentence: "Around him are rows of wooden desks and ...benches...." },
            { en: "blackboard", ipa: "/ËˆblÃ¦kËŒbÉ”Ërd/", zh: "é»‘æ¿", sentence: "The ...blackboard... shows mysterious formulas." },
            { en: "books", ipa: "/bÊŠks/", zh: "æ›¸æœ¬", sentence: "Many old ...books... are stacked." },
            { en: "bookshelves", ipa: "/ËˆbÊŠkËŒÊƒelvs/", zh: "æ›¸æ¶", sentence: "The ...bookshelves... lining the stone walls." },
            { en: "candelabra", ipa: "/ËŒkÃ¦ndÉ™ËˆlÉ‘ËbrÉ™/", zh: "ç‡­å°", sentence: "A decorative ...candelabra... sits on a table." },
            { en: "ceiling", ipa: "/ËˆsiËlÉªÅ‹/", zh: "å¤©èŠ±æ¿", sentence: "Look up at the high arched ...ceiling...." },
            { en: "chalk", ipa: "/tÊƒÉ”Ëk/", zh: "ç²‰ç­†", sentence: "perhaps drawn with a piece of ...chalk...." },
            { en: "classroom", ipa: "/ËˆklÉ‘ËsËŒruËm/", zh: "æ•™å®¤", sentence: "Welcome to the magical ...classroom...." },
            { en: "crest", ipa: "/krest/", zh: "å¾½ç« ", sentence: "His house ...crest... is visible." },
            { en: "desks", ipa: "/desks/", zh: "èª²æ¡Œ", sentence: "Around him are rows of wooden ...desks...." },
            { en: "flasks", ipa: "/flÃ¦sks/", zh: "ç‡’ç“¶", sentence: "You can find laboratory tools like ...flasks...." },
            { en: "inkwells", ipa: "/ËˆÉªÅ‹kwelz/", zh: "å¢¨æ°´ç“¶", sentence: "Quills dipped in ...inkwells...." },
            { en: "jars", ipa: "/dÊ’É‘Ërz/", zh: "ç½å­", sentence: "You can find laboratory tools like flasks and glass ...jars...." },
            { en: "light", ipa: "/laÉªt/", zh: "å…‰ç·š", sentence: "The natural ...light... streams in." },
            { en: "quills", ipa: "/kwÉªlz/", zh: "ç¾½æ¯›ç­†", sentence: "You can find writing tools like ...quills...." },
            { en: "robe", ipa: "/roÊŠb/", zh: "é•·è¢", sentence: "He is dressed in a black ...robe...." },
            { en: "shoes", ipa: "/ÊƒuËz/", zh: "é‹å­", sentence: "On his feet are polished black ...shoes...." },
            { en: "stone floor", ipa: "/stoÊŠn flÉ”Ër/", zh: "çŸ³åœ°æ¿", sentence: "The room has a cold ...stone floor...." },
            { en: "stone walls", ipa: "/stoÊŠn wÉ”Ëlz/", zh: "çŸ³ç‰†", sentence: "The room is built with solid ...stone walls...." },
            { en: "student", ipa: "/ËˆstuËdÉ™nt/", zh: "å­¸ç”Ÿ", sentence: "A serious ...student... stands in the center." },
            { en: "sweater vest", ipa: "/ËˆswetÉ™r vest/", zh: "èƒŒå¿ƒ", sentence: "He wears a striped ...sweater vest...." },
            { en: "tie", ipa: "/taÉª/", zh: "é ˜å¸¶", sentence: "He wears a matching ...tie...." },
            { en: "trousers", ipa: "/ËˆtraÊŠzÉ™rz/", zh: "é•·è¤²", sentence: "He is wearing grey ...trousers...." },
            { en: "wand", ipa: "/wÉ‘Ënd/", zh: "é­”æ–", sentence: "He is ready for a lesson, holding his ...wand...." },
            { en: "windows", ipa: "/ËˆwÉªndoÊŠz/", zh: "çª—æˆ¶", sentence: "Light streams in through the tall Gothic ...windows...." }
        ];

        const storyTexts = [
            "Welcome to the magical classroom. Look up at the high arched ceiling. The natural light streams in through the tall Gothic windows. The room is built with solid stone walls and has a cold stone floor.",
            "A serious student stands in the center. He is dressed in a black robe over a striped sweater vest and grey trousers. His house crest is visible, and he wears a matching tie. He is ready for a lesson, holding his wand. On his feet are polished black shoes.",
            "Around him are rows of wooden desks and benches. On the bookshelves lining the stone walls, many old books are stacked. The blackboard shows mysterious formulas, perhaps drawn with a piece of chalk. On the desks, you can find laboratory tools like flasks and glass jars, alongside writing tools: quills dipped in inkwells. A decorative candelabra sits on a table, waiting to be lit."
        ];

        const storyParagraphs = [
            `Welcome to the magical <span class="word-red" onclick="speak('classroom')">classroom</span>. Look up at the high arched <span class="word-red" onclick="speak('ceiling')">ceiling</span>. The natural <span class="word-red" onclick="speak('light')">light</span> streams in through the tall Gothic <span class="word-red" onclick="speak('windows')">windows</span>. The room is built with solid <span class="word-red" onclick="speak('stone walls')">stone walls</span> and has a cold <span class="word-red" onclick="speak('stone floor')">stone floor</span>.`,
            `A serious <span class="word-red" onclick="speak('student')">student</span> stands in the center. He is dressed in a black <span class="word-red" onclick="speak('robe')">robe</span> over a striped <span class="word-red" onclick="speak('sweater vest')">sweater vest</span> and grey <span class="word-red" onclick="speak('trousers')">trousers</span>. His house <span class="word-red" onclick="speak('crest')">crest</span> is visible, and he wears a matching <span class="word-red" onclick="speak('tie')">tie</span>. He is ready for a lesson, holding his <span class="word-red" onclick="speak('wand')">wand</span>. On his feet are polished black <span class="word-red" onclick="speak('shoes')">shoes</span>.`,
            `Around him are rows of wooden <span class="word-red" onclick="speak('desks')">desks</span> and <span class="word-red" onclick="speak('benches')">benches</span>. On the <span class="word-red" onclick="speak('bookshelves')">bookshelves</span> lining the <span class="word-red" onclick="speak('stone walls')">stone walls</span>, many old <span class="word-red" onclick="speak('books')">books</span> are stacked. The <span class="word-red" onclick="speak('blackboard')">blackboard</span> shows mysterious formulas, perhaps drawn with a piece of <span class="word-red" onclick="speak('chalk')">chalk</span>. On the <span class="word-red" onclick="speak('desks')">desks</span>, you can find laboratory tools like <span class="word-red" onclick="speak('flasks')">flasks</span> and glass <span class="word-red" onclick="speak('jars')">jars</span>, alongside writing tools: <span class="word-red" onclick="speak('quills')">quills</span> dipped in <span class="word-red" onclick="speak('inkwells')">inkwells</span>. A decorative <span class="word-red" onclick="speak('candelabra')">candelabra</span> sits on a table, waiting to be lit.`
        ];

        window.onload = () => {
            document.getElementById('story-content').innerHTML = storyParagraphs.map(p => `<p>${p}</p>`).join('');
            renderVocab();
        };

        // --- Voice Logic ---
        let isReadingStory = false;

        function speak(text, callback) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance();
            msg.text = text;
            msg.lang = 'en-US';
            msg.rate = 0.85;
            if(callback) msg.onend = callback;
            window.speechSynthesis.speak(msg);
        }

        function toggleStoryReading() {
            if (isReadingStory) {
                window.speechSynthesis.cancel();
                stopStoryUI();
            } else {
                startStoryUI();
                readStoryPart(0);
            }
        }

        function readStoryPart(index) {
            if (index >= storyTexts.length || !isReadingStory) {
                stopStoryUI();
                return;
            }
            speak(storyTexts[index], () => {
                if(isReadingStory) setTimeout(() => readStoryPart(index + 1), 500);
            });
        }

        function startStoryUI() {
            isReadingStory = true;
            document.getElementById('read-btn-icon').innerHTML = '<i class="fas fa-stop-circle"></i>';
            document.getElementById('read-btn-text').innerText = 'åœæ­¢æ’­æ”¾';
            document.getElementById('read-story-btn').classList.add('reading-active');
        }

        function stopStoryUI() {
            isReadingStory = false;
            document.getElementById('read-btn-icon').innerHTML = '<i class="fas fa-volume-up"></i>';
            document.getElementById('read-btn-text').innerText = 'è½å®Œæ•´æ•…äº‹';
            document.getElementById('read-story-btn').classList.remove('reading-active');
        }

        // --- UI & Tabs ---
        function switchTab(tab) {
            const sections = ['scene-section', 'vocab-section', 'quiz-section'];
            const buttons = ['btn-scene', 'btn-vocab', 'btn-quiz'];
            sections.forEach(s => document.getElementById(s).classList.add('hidden'));
            buttons.forEach(b => {
                const btn = document.getElementById(b);
                btn.classList.remove('tab-active', 'text-indigo-700');
                btn.classList.add('text-gray-500');
            });
            document.getElementById(`${tab}-section`).classList.remove('hidden');
            const activeBtn = document.getElementById(`btn-${tab}`);
            activeBtn.classList.add('tab-active', 'text-indigo-700');
            activeBtn.classList.remove('text-gray-500');
            
            window.speechSynthesis.cancel();
            stopStoryUI();
            if(tab === 'quiz') resetQuizUI();
        }

        function renderVocab() {
            const grid = document.getElementById('vocab-grid');
            grid.innerHTML = wordData.map(word => `
                <div class="bg-white p-6 rounded-2xl shadow border border-gray-100 group">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="text-xl font-black text-gray-800 group-hover:text-indigo-600">${word.en}</h3>
                        <button onclick="speak('${word.en}')" class="w-10 h-10 rounded-full bg-indigo-50 text-indigo-500 hover:bg-indigo-600 hover:text-white transition-all flex items-center justify-center">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                    <p class="text-xs font-mono text-gray-400 mb-1">${word.ipa}</p>
                    <p class="text-lg text-indigo-600 font-bold mb-4">${word.zh}</p>
                    <div class="pt-4 border-t border-dashed border-gray-200">
                        <p class="text-sm text-gray-500 italic">"${word.sentence.replace('...', `<span class='font-bold text-indigo-700'>${word.en}</span>`)}"</p>
                    </div>
                </div>
            `).join('');
        }

        // --- Quiz System ---
        let quizPool = [];
        let currentQuizIndex = 0;
        let quizScore = 0;
        const TOTAL_QUIZ_QUESTIONS = 10;

        function resetQuizUI() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('quiz-result-screen').classList.add('hidden');
            document.getElementById('quiz-start-screen').classList.remove('hidden');
        }

        function startQuiz() {
            quizPool = [...wordData].sort(() => Math.random() - 0.5).slice(0, TOTAL_QUIZ_QUESTIONS);
            currentQuizIndex = 0;
            quizScore = 0;
            document.getElementById('quiz-start-screen').classList.add('hidden');
            document.getElementById('quiz-result-screen').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            const feedback = document.getElementById('quiz-feedback');
            const nextBtn = document.getElementById('next-quiz-btn');
            feedback.classList.add('hidden');
            nextBtn.classList.add('hidden');
            const currentWord = quizPool[currentQuizIndex];
            document.getElementById('quiz-progress').innerText = `Question ${currentQuizIndex + 1}/${TOTAL_QUIZ_QUESTIONS}`;
            document.getElementById('quiz-live-score').innerText = `Score: ${quizScore}`;
            document.getElementById('quiz-question').innerHTML = `è«‹é¸æ“‡ã€Œ<span class="text-indigo-600">${currentWord.zh}</span>ã€çš„æ­£ç¢ºè‹±æ–‡ï¼š`;

            let options = [currentWord.en];
            while (options.length < 4) {
                const randomEn = wordData[Math.floor(Math.random() * wordData.length)].en;
                if (!options.includes(randomEn)) options.push(randomEn);
            }
            options.sort(() => Math.random() - 0.5);

            const optionsContainer = document.getElementById('quiz-options');
            optionsContainer.innerHTML = options.map(opt => `
                <button onclick="handleAnswer('${opt}', this)" class="w-full text-left p-4 rounded-xl border-2 border-gray-100 hover:border-indigo-300 hover:bg-indigo-50 transition-all font-bold text-gray-700 bg-white shadow-sm">
                    ${opt}
                </button>
            `).join('');
        }

        function handleAnswer(selected, element) {
            const feedback = document.getElementById('quiz-feedback');
            const nextBtn = document.getElementById('next-quiz-btn');
            const buttons = document.querySelectorAll('#quiz-options button');
            const currentAnswer = quizPool[currentQuizIndex].en;
            buttons.forEach(btn => btn.disabled = true);
            feedback.classList.remove('hidden');

            if (selected === currentAnswer) {
                quizScore++;
                element.classList.add('border-green-500', 'bg-green-50', 'text-green-700');
                feedback.innerHTML = `<i class="fas fa-check-circle mr-2"></i> æ­£ç¢ºï¼`;
                feedback.className = "mt-6 p-4 rounded-xl text-center font-bold bg-green-100 text-green-700";
                speak(currentAnswer);
            } else {
                element.classList.add('border-red-500', 'bg-red-50', 'text-red-700');
                feedback.innerHTML = `<i class="fas fa-times-circle mr-2"></i> ç­”æ¡ˆæ˜¯ ${currentAnswer}`;
                feedback.className = "mt-6 p-4 rounded-xl text-center font-bold bg-red-100 text-red-700";
            }
            document.getElementById('quiz-live-score').innerText = `Score: ${quizScore}`;
            nextBtn.classList.remove('hidden');
            nextBtn.innerHTML = (currentQuizIndex === TOTAL_QUIZ_QUESTIONS - 1) ? 'æŸ¥çœ‹çµæœ' : 'ä¸‹ä¸€é¡Œ';
        }

        function nextQuestion() {
            currentQuizIndex++;
            if (currentQuizIndex < TOTAL_QUIZ_QUESTIONS) showQuestion();
            else showResult();
        }

        function showResult() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('quiz-result-screen').classList.remove('hidden');
            document.getElementById('result-text').innerText = `å¾—åˆ†ï¼š${quizScore} / ${TOTAL_QUIZ_QUESTIONS}`;
            const emoji = document.getElementById('result-emoji');
            if (quizScore >= 9) emoji.innerText = "ğŸ§™â€â™‚ï¸";
            else if (quizScore >= 7) emoji.innerText = "ğŸ“œ";
            else emoji.innerText = "ğŸ’¡";
        }
    </script>
</body>
</html>
